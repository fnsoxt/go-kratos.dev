(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[7503],{3905:function(e,t,r){"use strict";r.d(t,{Zo:function(){return c},kt:function(){return d}});var n=r(7294);function o(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function a(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function i(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?a(Object(r),!0).forEach((function(t){o(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):a(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function p(e,t){if(null==e)return{};var r,n,o=function(e,t){if(null==e)return{};var r,n,o={},a=Object.keys(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||(o[r]=e[r]);return o}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}var s=n.createContext({}),l=function(e){var t=n.useContext(s),r=t;return e&&(r="function"==typeof e?e(t):i(i({},t),e)),r},c=function(e){var t=l(e.components);return n.createElement(s.Provider,{value:t},e.children)},u={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},g=n.forwardRef((function(e,t){var r=e.components,o=e.mdxType,a=e.originalType,s=e.parentName,c=p(e,["components","mdxType","originalType","parentName"]),g=l(r),d=o,h=g["".concat(s,".").concat(d)]||g[d]||u[d]||a;return r?n.createElement(h,i(i({ref:t},c),{},{components:r})):n.createElement(h,i({ref:t},c))}));function d(e,t){var r=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var a=r.length,i=new Array(a);i[0]=g;var p={};for(var s in t)hasOwnProperty.call(t,s)&&(p[s]=t[s]);p.originalType=e,p.mdxType="string"==typeof e?e:o,i[1]=p;for(var l=2;l<a;l++)i[l]=r[l];return n.createElement.apply(null,i)}return n.createElement.apply(null,r)}g.displayName="MDXCreateElement"},7574:function(e,t,r){"use strict";r.r(t),r.d(t,{frontMatter:function(){return i},contentTitle:function(){return p},metadata:function(){return s},toc:function(){return l},default:function(){return u}});var n=r(2122),o=r(9756),a=(r(7294),r(3905)),i={id:"openapi",title:"OpenAPI Swagger",description:"OpenAPI Swagger",keywords:["Go","Kratos","Toolkit","Framework","Microservices","Protobuf","gRPC","HTTP"]},p=void 0,s={unversionedId:"guide/openapi",id:"guide/openapi",isDocsHomePage:!1,title:"OpenAPI Swagger",description:"OpenAPI Swagger",source:"@site/i18n/en/docusaurus-plugin-content-docs/current/guide/openapi.md",sourceDirName:"guide",slug:"/guide/openapi",permalink:"/en/docs/guide/openapi",editUrl:"https://github.com/go-kratos/go-kratos.dev/edit/main/i18n/en/docusaurus-plugin-content-docs/current/guide/openapi.md",version:"current",frontMatter:{id:"openapi",title:"OpenAPI Swagger",description:"OpenAPI Swagger",keywords:["Go","Kratos","Toolkit","Framework","Microservices","Protobuf","gRPC","HTTP"]},sidebar:"docs",previous:{title:"Protobuf Guideline",permalink:"/en/docs/guide/api-protobuf"},next:{title:"Dependency Injection",permalink:"/en/docs/guide/wire"}},l=[{value:"Method 1: Use plug-ins to provide the swagger API",id:"method-1-use-plug-ins-to-provide-the-swagger-api",children:[]},{value:"Method 2: Use protoc to generate swagger.json",id:"method-2-use-protoc-to-generate-swaggerjson",children:[]}],c={toc:l};function u(e){var t=e.components,r=(0,o.Z)(e,["components"]);return(0,a.kt)("wrapper",(0,n.Z)({},c,r,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("p",null,"The framework provides open API/Swagger use in two ways: 1. Provide swagger interface on service, 2. Use the protoc plug-in to generate the swagger.json file. Here are two ways to do this."),(0,a.kt)("h3",{id:"method-1-use-plug-ins-to-provide-the-swagger-api"},"Method 1: Use plug-ins to provide the swagger API"),(0,a.kt)("p",null,"Plugin ",(0,a.kt)("a",{parentName:"p",href:"https://github.com/go-kratos/swagger-api"},"swagger-api")," provides a range of swagger-related APIs, as well as the corresponding UI interface."),(0,a.kt)("h4",{id:"installation"},"Installation"),(0,a.kt)("p",null,"First install this plugin."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"go get -u github.com/go-kratos/swagger-api\n")),(0,a.kt)("p",null,"Then initialize and register in newHTTPServer of ",(0,a.kt)("inlineCode",{parentName:"p"},"internal/server/http.go"),", and try to put this route registration first to avoid match failed."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-go"},'import  "github.com/go-kratos/swagger-api/openapiv2"\n\nopenAPIhandler := openapiv2.NewHandler()\nsrv.HandlePrefix("/q/", openAPIhandler)\n')),(0,a.kt)("h4",{id:"usage"},"Usage"),(0,a.kt)("p",null,"Open ",(0,a.kt)("inlineCode",{parentName:"p"},"/q/swagger-ui/")," in Web Browser in order to access Swagger UI"),(0,a.kt)("h3",{id:"method-2-use-protoc-to-generate-swaggerjson"},"Method 2: Use protoc to generate swagger.json"),(0,a.kt)("p",null,"The new project Makefile has been integrated by default with the commands associated with generating swagger.json, and here's how to use them"),(0,a.kt)("h4",{id:"installation-1"},"Installation"),(0,a.kt)("p",null,"First, install the protoc plug-in"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"go get -u github.com/grpc-ecosystem/grpc-gateway/v2/protoc-gen-openapiv2\n")),(0,a.kt)("h4",{id:"generation"},"Generation"),(0,a.kt)("p",null,"(Recommended) run the following command at the root of the project for generation:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"make swagger\n")),(0,a.kt)("p",null,"Or use the protoc command directly at the root of the project, note that modifying the final proto file path of the command is the actual path"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"protoc --proto_path=. \\\n        --proto_path=./third_party \\\n        --openapiv2_out . \\\n        --openapiv2_opt logtostderr=true \\\n        --openapiv2_opt json_names_for_fields=false \\\n        api/helloworld/v1/greeter.proto\n")),(0,a.kt)("h4",{id:"usage-1"},"Usage"),(0,a.kt)("p",null,"Once the above command has been executed successfully, the corresponding swagger.json file will be generated in the directory where your proto file is located.\nYou can import it into any platform that supports the Open API specification for browsing, such as:"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("a",{parentName:"li",href:"https://github.com/swagger-api/swagger-ui"},"Swagger UI")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("a",{parentName:"li",href:"https://editor.swagger.io/"},"Swagger Editor")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("a",{parentName:"li",href:"https://github.com/Redocly/redoc"},"ReDoc")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("a",{parentName:"li",href:"https://github.com/YMFE/yapi"},"YApi")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("a",{parentName:"li",href:"https://www.postman.com/"},"Postman"))))}u.isMDXComponent=!0}}]);